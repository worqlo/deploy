# =============================================================================
# Worqlo Self-Hosted Configuration
# =============================================================================
# ⚠️  SECURITY WARNING: This is a template file
# • DO NOT use these example values in production
# • Generate secure secrets with: ./scripts/generate-secrets.sh > .env
# • Never commit .env to version control (it's in .gitignore)
# =============================================================================

# -----------------------------------------------------------------------------
# Security [REQUIRED]
# -----------------------------------------------------------------------------
# JWT secret for authentication (MINIMUM 32 characters, 64+ recommended)
# ⚠️  Generate with: openssl rand -base64 64
# ❌ DO NOT use this example value
JWT_WS_SECRET=CHANGE_THIS_TO_A_SECURE_64_CHAR_SECRET_GENERATED_WITH_OPENSSL

# NextAuth secret for frontend sessions (MINIMUM 32 characters, 64+ recommended)
# ⚠️  Generate with: openssl rand -base64 64
# ❌ DO NOT use this example value
NEXTAUTH_SECRET=CHANGE_THIS_TO_A_DIFFERENT_64_CHAR_SECRET_FOR_NEXTAUTH

# -----------------------------------------------------------------------------
# Database [REQUIRED]
# -----------------------------------------------------------------------------
POSTGRES_USER=worqlo
# ⚠️  Generate with: openssl rand -base64 32
# Minimum 16 characters, alphanumeric + special chars recommended
POSTGRES_PASSWORD=CHANGE_THIS_TO_A_SECURE_POSTGRES_PASSWORD
POSTGRES_DB=worqlo

# -----------------------------------------------------------------------------
# Redis [REQUIRED]
# -----------------------------------------------------------------------------
# ⚠️  Redis password is now REQUIRED for security (was optional)
# Generate with: openssl rand -base64 32
REDIS_PASSWORD=CHANGE_THIS_TO_A_SECURE_REDIS_PASSWORD

# -----------------------------------------------------------------------------
# MinIO Object Storage [REQUIRED]
# -----------------------------------------------------------------------------
MINIO_ROOT_USER=worqlo
# ⚠️  Generate with: openssl rand -base64 32
# Minimum 16 characters required by MinIO
MINIO_ROOT_PASSWORD=CHANGE_THIS_TO_A_SECURE_MINIO_PASSWORD
S3_BUCKET_NAME=worqlo
# Public URL for browser access to MinIO (presigned URLs).
# For on-premise: http://<your-server-ip-or-hostname>:9000
# For production with HTTPS, use https://yourdomain.com/... (nginx proxy)
# Leave empty to use S3_ENDPOINT_URL (only works if browser can reach it directly)
S3_PUBLIC_ENDPOINT_URL=http://localhost:9000
# Presigned URL expiry in seconds (default: 3600 = 1 hour, max: 604800 = 7 days)
S3_PRESIGNED_URL_EXPIRY=3600

# -----------------------------------------------------------------------------
# LLM Provider Configuration
# -----------------------------------------------------------------------------
# Options: openai, ollama, grok, sglang
LLM_PROVIDER=sglang

# OpenAI (if LLM_PROVIDER=openai)
OPENAI_API_KEY=sk-your-openai-api-key
OPENAI_MODEL=gpt-4o-mini

# Grok/xAI (if LLM_PROVIDER=grok)
GROK_API_KEY=your-grok-api-key
GROK_MODEL=grok-3-mini

# Ollama (if LLM_PROVIDER=ollama)
# Start with: docker compose --profile ollama up -d
OLLAMA_BASE_URL=http://ollama:11434
OLLAMA_MODEL=llama3.1:8b

# SGLang (if LLM_PROVIDER=sglang) - self-hosted inference
SGLANG_BASE_URL=http://your-sglang-host:30000
SGLANG_MODEL=openai/gpt-oss-120b
# SGLANG_REASONING_EFFORT=medium
# SGLANG_ENABLE_CODE_INTERPRETER=false
# SGLANG_ENABLE_WEB_SEARCH=false

# -----------------------------------------------------------------------------
# Embedding Configuration (Knowledge Base)
# -----------------------------------------------------------------------------
# Provider: openai (uses OPENAI_API_KEY) or sglang (uses KB_EMBEDDING_BASE_URL)
KB_EMBEDDING_PROVIDER=openai

# SGLang embedding server (only when KB_EMBEDDING_PROVIDER=sglang)
# Base URL including /v1. Example: http://192.168.0.2:30001/v1
# KB_EMBEDDING_BASE_URL=http://your-embedding-host:30001/v1

# Model name: HuggingFace format for SGLang, or OpenAI model name
KB_EMBEDDING_MODEL=text-embedding-3-small

# Dimensions (must match model output and document_chunks.embedding column)
# text-embedding-3-small (OpenAI): 1536
# Qwen3-Embedding-4B (SGLang): 2560
# If changing dimensions, run a migration to alter the embedding column and re-upload documents.
KB_EMBEDDING_DIMENSIONS=1536

# -----------------------------------------------------------------------------
# URLs (adjust for your domain)
# -----------------------------------------------------------------------------
# BASE_URL: Override for IP or domain access. When set, install.sh derives all URL vars.
# Example: BASE_URL=http://192.168.1.100 (network access) or BASE_URL=https://worqlo.company.com
#
# Client-side API URL (browser → nginx reverse proxy → backend)
# Set by install.sh based on your choice (localhost / IP / domain)
# ⚠️  IMPORTANT: Must include /api suffix - all backend routes are under /api
NEXT_PUBLIC_API_URL=http://localhost/api
NEXT_PUBLIC_WEBSOCKET_URL=ws://localhost/ws
NEXTAUTH_URL=http://localhost

# Server-side API URL (Next.js API routes → backend in Docker)
# ⚠️  IMPORTANT: Must include /api suffix - all backend routes are under /api
# This is set automatically in docker-compose.yml to http://api:8000/api
# Only override if you need a custom internal network URL
# BACKEND_API_URL=http://custom-backend:8000/api

# Frontend URLs for email links (activation, password reset)
# Must match your actual frontend URL - used in welcome/activation emails
FRONTEND_RESET_PASSWORD_URL=http://localhost/reset-password
FRONTEND_LOGIN_URL=http://localhost

# Internal Chat UI URL (backend proxies root / to Chat UI when tenants exist)
# Docker default: http://chat-ui:3000
# CHAT_UI_INTERNAL_URL=http://chat-ui:3000

# -----------------------------------------------------------------------------
# Ports
# -----------------------------------------------------------------------------
HTTP_PORT=80
HTTPS_PORT=443

# -----------------------------------------------------------------------------
# JWT Settings
# -----------------------------------------------------------------------------
JWT_ISSUER=worqlo-self-hosted
JWT_AUDIENCE=worqlo-backend-api
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_HOURS=24

# -----------------------------------------------------------------------------
# Email
# -----------------------------------------------------------------------------
# Email is pre-configured with Worqlo's SMTP server.
# No configuration needed - emails work out of the box.

# -----------------------------------------------------------------------------
# CORS (⚠️  Security: Do not use wildcard '*' in production!)
# -----------------------------------------------------------------------------
# Set by install.sh based on your choice (localhost / IP / domain)
# Comma-separated list of allowed origins
CORS_ALLOW_ORIGINS=http://localhost,http://localhost:80,http://localhost:3000

# Production example (replace with your domains):
# CORS_ALLOW_ORIGINS=https://yourdomain.com,https://app.yourdomain.com
#
# ⚠️  NEVER use CORS_ALLOW_ORIGINS=* in production!
# This allows any website to make requests to your API (security risk)

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
# Options: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# Debug (Production: keep all false, LOG_LEVEL=INFO)
# -----------------------------------------------------------------------------
# Set to true only for troubleshooting. Never use in production.
# DEBUG_CONNECTOR_HTTP=false
# DEBUG_CONNECTORS_VERBOSE=false
# DEBUG_WORKFLOWS=false
# LOG_TOOL_RESPONSE=false

# -----------------------------------------------------------------------------
# Grafana (for observability stack)
# -----------------------------------------------------------------------------
GRAFANA_ADMIN_USER=admin
# ⚠️  Generate with: openssl rand -base64 16
GRAFANA_ADMIN_PASSWORD=CHANGE_THIS_TO_A_SECURE_GRAFANA_PASSWORD
GRAFANA_ROOT_URL=http://localhost:3001

# -----------------------------------------------------------------------------
# LangSmith Observability (optional)
# -----------------------------------------------------------------------------
LANGSMITH_TRACING=false
LANGSMITH_API_KEY=
LANGSMITH_PROJECT=worqlo-self-hosted

# -----------------------------------------------------------------------------
# Storage
# -----------------------------------------------------------------------------
STORAGE_BACKEND=s3
S3_REGION=us-east-1

# -----------------------------------------------------------------------------
# Salesforce OAuth (optional - defaults work for localhost)
# -----------------------------------------------------------------------------
# Override these if using a custom Salesforce Connected App or different domain
# SALESFORCE_CLIENT_ID=your-connected-app-consumer-key
# SALESFORCE_CLIENT_SECRET=your-connected-app-consumer-secret
# SALESFORCE_REDIRECT_URI=http://localhost:3000/integrations/salesforce/callback
#
# For production with domain:
# SALESFORCE_REDIRECT_URI=https://yourdomain.com/integrations/salesforce/callback

# -----------------------------------------------------------------------------
# Pre-built images from GitHub Container Registry (optional)
# -----------------------------------------------------------------------------
# Set these when using docker-compose.ghcr.yml to pull images instead of building.
# Leave unset to build from source (default).
# GHCR_REGISTRY=ghcr.io
# GHCR_OWNER=your-github-org-or-username
# IMAGE_TAG=latest

